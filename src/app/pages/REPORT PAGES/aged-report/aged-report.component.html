<div id="reportPage" class="view-wrapper list-page drilldown mt-20">
  <!-- <div class="paramsDiv"> -->
  <div
    id="reportPageParams"
    class="paramsDiv SearchParams-container"
    [ngClass]="{ 'hide-content': !isContentVisible }"
  >
    <dx-form>
      <dxi-item
        itemType="group"
        cssClass="form-group"
        style="margin-left: 40px;"
        [colCount]="5"

      >


        <dxi-item [colSpan]="1">
          <dx-date-box
            labelMode="floating"
            labelLocation="left"
            label="From Date"
            type="date"
            displayFormat="dd/MM/yyyy"
            valueFormat="yyyy/MM/dd"
            [(value)]="From_Date_Value"
            [min]="minDate"
            [max]="maxDate"
          >
          </dx-date-box>
        </dxi-item>

        <dxi-item [colSpan]="1">
          <dx-date-box
            labelMode="floating"
            labelLocation="left"
            label="To Date"
            type="date"
            displayFormat="dd/MM/yyyy"
            valueFormat="yyyy/MM/dd"
            [(value)]="To_Date_Value"
            [min]="minDate"
            [max]="maxDate"
          >
          </dx-date-box>
        </dxi-item>
                <dxi-item [colSpan]="1">
          <div>
                      <dx-date-box
            labelMode="floating"
            labelLocation="left"
            label="As on Date"
            type="date"
            displayFormat="dd/MM/yyyy"
            valueFormat="yyyy/MM/dd"
            [(value)]="As_on_date"
            [min]="minDate"
            [max]="maxDate"
          >
          </dx-date-box>

          </div>
        </dxi-item>

        <dxi-item [colSpan]="1" class="mt-1">
          <dx-button
            class="add-card"
            icon="todo"
            text="Apply"
            type="default"
            stylingMode="contained"
            (onClick)="get_Datagrid_DataSource()"
          >
          </dx-button>
        </dxi-item>
      </dxi-item>
    </dx-form>
  </div>
  <!-- </div> -->
  <div class="button-container mt-1 mb-2">
    <dx-button
      class="toggleButton"
      icon="{{ isContentVisible ? 'chevronup' : 'chevrondown' }}"
    
      type="normal"
      [hint]="isContentVisible ? 'Hide Filter Contend' : 'Show Filter Contend'"
      [width]="200"
      [height]="13"
      (onClick)="toggleContent()"
    >
    </dx-button>
  </div>
  <!-- ====================================Data GRid Table started================================ -->
  <ng-container>
    <dx-data-grid
      id="dataGrid"
      #dataGrid
      class="grid reportGrid reportGridFooter theme-dependent"
      [height]="isContentVisible ? '80vh' : '80vh'"
      [noDataText]="!isContentVisible ? ' ' : 'No data '"
      [dataSource]="dataGrid_DataSource"
      [showBorders]="true"
      [allowColumnResizing]="false"
      [columnAutoWidth]="true"
      [rowAlternationEnabled]="true"
      rowAlternationInterval="2"
      [allowColumnReordering]="true"
      [filterRow]="{ visible: false }"
      (onCellClick)="onCellClick($event)"
      [headerFilter]="{ visible: false }"
      [columnFixing]="{
        enabled: true,
        texts: { fix: 'Freeze', unfix: 'Unfreeze' }
      }"
      (onExporting)="onExporting($event)"
      [summary]="summaryColumnsData"
        (onRowExpanding)="onRowExpanding($event)"
  (onRowCollapsed)="onRowCollapsed($event)"
    (onContentReady)="onContentReady()"
    >
    
<dxi-column dataField="InsuranceCode" caption="InsuranceCode"></dxi-column>
<dxi-column dataField="InsuranceName" caption="InsuranceName"></dxi-column>
<!-- <dxi-column dataField="AgeDays" caption="AgeDays"></dxi-column> -->
<dxi-column dataField="Days_0_30"   [format]="{ type: 'fixedPoint', precision: precision  }" caption=" 0–30"></dxi-column>
<dxi-column dataField="Days_31_60"  [format]="{ type: 'fixedPoint', precision: precision  }"  caption=" 31–60"></dxi-column>
<dxi-column dataField="Days_61_90"   [format]="{ type: 'fixedPoint', precision: precision  }" caption=" 61–90"></dxi-column>
<dxi-column dataField="Days_91_120"  [format]="{ type: 'fixedPoint', precision: precision  }" caption=" 91–120"></dxi-column>
<dxi-column dataField="Days_Above_120"  [format]="{ type: 'fixedPoint', precision: precision  }"  caption=" Above 120"></dxi-column>
<dxi-column dataField="TotalAmount"  [format]="{ type: 'fixedPoint', precision: precision  }"  caption="Total Amount"></dxi-column>
<!-- 
     <ng-container *ngFor="let column of columnsConfig">
  

    <dxi-column
      *ngIf="column.isBand"
      [caption]="column.caption"
      [isBand]="true"
    >
      <dxi-column
        *ngFor="let subColumn of column.columns"
        [dataField]="subColumn.dataField"
        [caption]="subColumn.caption"
        [format]="subColumn.format"
     
        [width]="150"
      ></dxi-column>
    </dxi-column>

    <dxi-column
      *ngIf="!column.isBand"
      [dataField]="column.dataField"
      [caption]="column.caption"
      [format]="column.format"
      [width]="150"
    ></dxi-column>
  
</ng-container> -->
<!-- </ng-container> -->
      <dxo-search-panel [visible]="true"></dxo-search-panel>
      <dxo-paging [pageSize]="20"></dxo-paging>
      <dxo-pager
        [visible]="true"
        [allowedPageSizes]="allowedPageSizes"
        [displayMode]="displayMode"
        [showPageSizeSelector]="showPageSizeSelector"
        [showInfo]="showInfo"
        [showNavigationButtons]="showNavButtons"
      >
      </dxo-pager>
      <dxo-load-panel [showPane]="false"></dxo-load-panel>
      <dxo-scrolling mode="virtual"></dxo-scrolling>
      <dxo-sorting mode="multiple"></dxo-sorting>
      <dxo-header-filter [visible]="true" highlight="true"></dxo-header-filter>

      <dxo-filter-panel [visible]="isFilterOpened"></dxo-filter-panel>
      <dxo-filter-builder [allowHierarchicalFields]="true">
      </dxo-filter-builder>

      <dxo-column-chooser
        [height]="500"
        hideOnOutsideClick="true"
        [enabled]="true"
        mode="select"
      >
      </dxo-column-chooser>

      <dxo-search-panel
        [visible]="true"
        placeholder="Search"
      ></dxo-search-panel>

      <dxo-filter-row
        [visible]="isFilterOpened"
        [applyFilter]="applyFilter"
      ></dxo-filter-row>
      <dxo-export
        [enabled]="true"
        [allowExportSelectedData]="true"
        [formats]="['xlsx']"
      >
      </dxo-export>
      <dxo-toolbar>
        <dxi-item location="before">
          <div class="grid-header">Ageing Report</div>
        </dxi-item>
        <dxi-item
          location="after"
          locateInMenu="auto"
          showText="inMenu"
          widget="dxButton"
          [options]="{
            text: 'Refresh',
            icon: 'refresh',
            onClick: refresh,
            stylingMode: 'text',
            disabled: isEmptyDatagrid,
            hint: 'Refresh'
          }"
        ></dxi-item>

        <dxi-item
          widget="dxButton"
          [options]="{
            text: '',
            icon: 'search',
            onClick: filterClick,
            disabled: isEmptyDatagrid,
            hint: 'Search Column'
          }"
        ></dxi-item>

        <dxi-item
          name="columnChooserButton"
          locateInMenu="auto"
          [disabled]="isEmptyDatagrid"
        ></dxi-item>

        <dxi-item
          widget="dxButton"
          [options]="{
            text: '',
            icon: 'formula',
            onClick: SummaryClick,
            hint: 'Hide/Show Summary',
            disabled: isEmptyDatagrid,
          }"
        ></dxi-item>

        <dxi-item name="exportButton" [disabled]="isEmptyDatagrid"></dxi-item>
<dxi-item
          class="columnfinderclass"
          widget="dxDropDownButton"
          [options]="{
            dataSource: DetailColumnNames,
            onItemClick: findColumnLocation,
            placeholder: 'Search Column',
            noDataText: 'Load data and try again',
            disabled: isEmptyDatagrid,
            hint: 'Column location finder',
            icon:'columnproperties',
            dropDownOptions: {
              width: 'auto',
              height: '60vh'
            },

          }"
        ></dxi-item> 

      </dxo-toolbar>

      <dxo-grouping
        [autoExpandAll]="false"
        [contextMenuEnabled]="true"
        [expandMode]="'rowClick'"
      ></dxo-grouping>
  <dxo-master-detail [enabled]="true" template="detail"></dxo-master-detail>
      <div class="ms-3" *dxTemplate="let data of 'detail'">
        <dx-data-grid
          #detailsdatagrid
          [dataSource]="FilteredDetailData"
          [showBorders]="true"
          [columnAutoWidth]="true"
          [rowAlternationEnabled]="true"
          [summary]="DetailsummaryColumns"
          [height]="'40vh'"
          [noDataText]=""
          (onCellClick)="onCellClick($event)"
           (onContentReady)="onDetailGridReady(detailsdatagrid)"
        >
         <dxo-header-filter [visible]="true" highlight="true"></dxo-header-filter>
          <dxo-scrolling 
      mode="standard" 
      direction="both" 
      showScrollbar="always">
  </dxo-scrolling>
          <dxo-pager
            [visible]="false"
            [allowedPageSizes]="allowedPageSizes"
            [displayMode]="displayMode"
            [showPageSizeSelector]="showPageSizeSelector"
            [showInfo]="showInfo"
            [showNavigationButtons]="showNavButtons"

          >
          </dxo-pager>
<dxi-column dataField="InsuranceCode" caption="InsuranceCode"></dxi-column>
<dxi-column dataField="InsuranceName" caption="InsuranceName"></dxi-column>
<!-- <dxi-column dataField="AgeDays" caption="AgeDays"></dxi-column> -->
<dxi-column dataField="Days_0_30"  [format]="{ type: 'fixedPoint', precision: precision  }"  caption=" 0–30"></dxi-column>
<dxi-column dataField="Days_31_60"  [format]="{ type: 'fixedPoint', precision: precision  }"  caption=" 31–60"></dxi-column>
<dxi-column dataField="Days_61_90"  [format]="{ type: 'fixedPoint', precision: precision  }"  caption=" 61–90"></dxi-column>
<dxi-column dataField="Days_91_120"  [format]="{ type: 'fixedPoint', precision: precision  }"  caption=" 91–120"></dxi-column>
<dxi-column dataField="Days_Above_120"  [format]="{ type: 'fixedPoint', precision: precision  }"  caption=" Above 120"></dxi-column>
<dxi-column dataField="TotalAmount"  [format]="{ type: 'fixedPoint', precision: precision  }"  caption="Total Amount"></dxi-column>
<dxi-column dataField="TRANSACTION_DATE" caption="Transaction Date" dataType="date"   format="dd-MM-yyyy"></dxi-column>
<dxi-column dataField="INVOICE_NO" caption="Invoice No"></dxi-column>
<dxi-column dataField="PREINVOICENO" caption="PreInvoice No"></dxi-column>
<dxi-column dataField="GROSS_CLAIM"  [format]="{ type: 'fixedPoint', precision: precision  }"  caption="Gross Claim"></dxi-column>
<dxi-column dataField="DISCOUNT_CLAIM"  [format]="{ type: 'fixedPoint', precision: precision  }"  caption="Discount Claim"></dxi-column>
<dxi-column dataField="NET_RA"  [format]="{ type: 'fixedPoint', precision: precision  }"  caption="Net Payable"></dxi-column>
<dxi-column dataField="DISCOUNT_RA"  [format]="{ type: 'fixedPoint', precision: precision  }"  caption="Discount RA"></dxi-column>
<dxi-column dataField="EXCEEDING_LIMITED"  [format]="{ type: 'fixedPoint', precision: precision  }"  caption="Exceeding Limited"></dxi-column>
<dxi-column dataField="REJECTED_AMOUNT"  [format]="{ type: 'fixedPoint', precision: precision  }"  caption="Rejected Amount"></dxi-column>
<dxi-column dataField="PATIENT_ID" caption="Patient ID"></dxi-column>
<dxi-column dataField="CIVIL_ID" caption="Civil ID"></dxi-column>
<dxi-column dataField="IPOP" caption="IP/OP"></dxi-column>
<dxi-column dataField="BENEFICIARY_NAME" caption="Beneficiary Name"></dxi-column>
<dxi-column dataField="TREATING_PHYSICIAN" caption="Treating Physician"></dxi-column>
<dxi-column dataField="ITEM_CODE" caption="Item Code"></dxi-column>
<dxi-column dataField="ITEM_DESCRIPTION" caption="Item Description"></dxi-column>
<dxi-column dataField="MAIN_SYMPTOMS" caption="Main Symptoms"></dxi-column>
<dxi-column dataField="STATUS_NAME" caption="Status"></dxi-column>
<dxi-column dataField="BATCH_NO" caption="Batch No"></dxi-column>
<dxi-column dataField="PAYER" caption="Payer"></dxi-column>

       
          <dxo-scrolling mode="virtual"></dxo-scrolling>
          <dxo-header-filter [visible]="isFilterOpened">
            <dxo-search [enabled]="true"></dxo-search>
          </dxo-header-filter>
          <dxo-filter-row
            [visible]="isFilterOpened"
            [applyFilter]="applyFilter"
          ></dxo-filter-row>
    
        </dx-data-grid>
      </div>
   
      <dxo-header-filter [visible]="true">
        <dxo-search [enabled]="true"></dxo-search>
      </dxo-header-filter>
    </dx-data-grid>
  </ng-container>
</div>
<dx-load-panel
  #loadPanel
  shadingColor="rgba(0,0,0,0.0)"
  [(visible)]="loadingVisible"
  [showIndicator]="true"
  [showPane]="true"
  [shading]="true"
  [hideOnOutsideClick]="false"
  [message]="'Loading...'"
>
</dx-load-panel>
